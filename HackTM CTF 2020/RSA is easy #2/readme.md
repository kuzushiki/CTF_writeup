RSA問第2弾

先ほどの問題とほぼ同じ設定だが、今度は公開鍵の値が分からない
よって総当たり攻撃はできない

しばらくして暗号文が異様に多いことに気が付く

同じ鍵で暗号化されてるので、暗号文が同じであれば平文も同じであることを利用

暗号文を`a-zA-Z`で置換するスクリプトを書いた
`solve.py`

結果は以下の通り
```
abcdefeaghefdeijkkclcefdembcecgnkoepqhrefesctfhcseabgmefeuckfctcseaghegeunfkkfgdmecdinovmfjdehibcwcxegehfwvkcevhcysjngdsjwedywucnehmncgweaghegsscsemjembcevkgfdmczmehmncgwemjeincgmceifvbcnmczmxembfheajyksehccwfdlkoembagnmegdoeAncBycdioegdgkohfhejAembceifvbcnmczmregdseajykseuceydingiCgukcectcdemjembcewjhmenchjynicAykeljtcndwcdmefdmckkflcdiceglcdifchxefeAckmehjehwylegujymewoegibfctcwcdmxeocgnhekgmcnrefesfhijtcncsembfhehgwcehibcwcefdehctcngkefdmnjsyimjnoeinovmjlngvboemczmhegdsemymjnfgkevgvcnhxebjaedficxejmbcneinovmjlngvbcnhebgsembjylbmejAembcehgwcehibcwcxeydAjnmydgmckorembcehibcwceaghevnchcdmcseghegehfwvkcebjwcajnCeghhfldwcdmejdebjaemjeyhceckcwcdmgnoeinovmgdgkomfiemcibdfBychemjemnftfgkkoeingiCefmxehjewyibeAjnewoeunfkkfgdmehibcwcxeAnjwembfhebywukfdleczvcnfcdicefekcgndcsebjaecghoefmefhemjeAgkkefdmjegeAgkhcehcdhcejAehciynfmoeabcdesctfhfdlegdecdinovmfjdegkljnfmbwxewjhmevcjvkcesjdDmencgkfEcebjaeAfcdsfhbkoesfAAfiykmefmefhemjesctfhcegdecdinovmfjdegkljnfmbwembgmeigdeafmbhmgdsegevnjkjdlcsegdsescmcnwfdcsegmmgiCeuoegenchjynicAykejvvjdcdmxebcncefhembceAkglxeabcdefmeijwchemjeinovmjejneignvcmedctcnenjkkeojynejad
```

このままではaが元々のどの文字と対応するかが分からないが、
これだけ文字が多ければ、頻度分析を行うことが可能
[参考](https://ja.wikipedia.org/wiki/%E9%A0%BB%E5%BA%A6%E5%88%86%E6%9E%90_(%E6%9A%97%E5%8F%B7))

手作業で頻度分析を行うのは面倒くさいのでツールを使った
[ここ](https://www.guballa.de/substitution-solver)

復号結果は以下の通り
```
fhensisfamsinscollegesinsthesearlysqzmjsisdevimedsfhatsisbelievedsfamsasbrilliantsencryptionsmchekewsasmikplespmeudorandoksnukbersmtreaksfamsaddedstosthesplaintextsmtreakstoscreatesciphertextwsthimsfouldsmeekinglysthfartsanysFreHuencysanalymimsoFsthesciphertextjsandsfouldsbesuncracEablesevenstostheskomtsremourceFulsgovernkentsintelligencesagenciemwsisFeltsmosmkugsaboutskysachievekentwsyearmslaterjsisdimcoveredsthimsmakesmchekesinsmeveralsintroductoryscryptographystextmsandstutorialspapermwshofsnicewsotherscryptographermshadsthoughtsoFsthesmakesmchekewsunFortunatelyjsthesmchekesfamsprementedsamsasmikpleshokeforEsammignkentsonshofstosumeselekentaryscryptanalyticstechniHuemstostriviallyscracEsitwsmoskuchsForskysbrilliantsmchekewsFroksthimshukblingsexperiencesislearnedshofseamysitsimstosFallsintosasFalmesmenmesoFsmecuritysfhensdevimingsansencryptionsalgorithkwskomtspeoplesdonNtsrealiSeshofsFiendimhlysdiFFicultsitsimstosdevimesansencryptionsalgorithksthatscansfithmtandsasprolongedsandsdeterkinedsattacEsbysasremourceFulsopponentwsheresimsthesFlagwsfhensitscokemstoscryptosorscarpetsneversrollsyoursofn
```

最後の方に見える文章がそれっぽい
`Flagwsfhensitscokemstoscryptosorscarpetsneversrollsyoursofn`

`Flag`, `crypto`, `carpet`, `never`などの単語が確認できる

`s`という文字が各単語の両端にある

CTFのフラグは単語間が`_`で繋がれていることが多いので、`_`に置換する
`Flagw_fhen_it_cokem_to_crypto_or_carpet_never_roll_your_ofn`

`fhen_it_cokem_to`から`when it comes to`というフレーズが連想できるので、`f`を`w`、`k`を`m`、`m`を`s`に置換

`Flagw_when_it_comes_to_crypto_or_carpet_never_roll_your_own`

フラグゲット
`HackTM{when_it_comes_to_crypto_or_carpet_never_roll_your_own}`

